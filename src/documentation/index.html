<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.37">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Projet Données Satellites – index</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<link href="../../src/documentation/sections/satellite_image.html" rel="next">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="../../site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script src="https://kit.fontawesome.com/78ddb093ea.js" crossorigin="anonymous"></script>
<link rel="icon" type="image/png" sizes="32x32" href="src/_extensions/InseeFrLab/onyxia/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="32x32" href="../_extensions/InseeFrLab/onyxia/favicon-32x32.png">


<meta property="og:title" content="Projet Données Satellites">
<meta property="og:description" content="">
<meta property="og:site_name" content="Projet Données Satellites">
</head>

<body class="nav-sidebar docked nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a href="../../index.html" class="navbar-brand navbar-brand-logo">
    <img src="https://upload.wikimedia.org/wikipedia/fr/thumb/1/10/Logo_Insee.svg/1200px-Logo_Insee.svg.png" alt="" class="navbar-logo">
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../index.html"> 
<span class="menu-text">Accueil</span></a>
  </li>  
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/orgs/InseeFrLab/teams/satellite-images/repositories"> <i class="bi bi-github" role="img" aria-label="GitHub">
</i> 
<span class="menu-text"></span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../../src/documentation/index.html">Navigation</a></li><li class="breadcrumb-item"><a href="../../src/documentation/index.html">Accueil</a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation docked overflow-auto">
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">Navigation</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../src/documentation/index.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">Accueil</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../src/documentation/sections/satellite_image.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Une image satellite</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../src/documentation/sections/acquisition.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Acquisition</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../src/documentation/sections/entrainement.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Entraînement d’un modèle</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../src/documentation/sections/resultats.qmd" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Mise à disposition des résultats</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../src/documentation/sections/pipeline.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Pipeline du projet</span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#structure-du-projet" id="toc-structure-du-projet" class="nav-link active" data-scroll-target="#structure-du-projet">📦 Structure du projet</a>
  <ul class="collapse">
  <li><a href="#les-différents-dépôts" id="toc-les-différents-dépôts" class="nav-link" data-scroll-target="#les-différents-dépôts">📁 Les différents dépôts</a>
  <ul class="collapse">
  <li><a href="#astrovision-package-utilitaire-pour-le-traitement-dimages-satellites" id="toc-astrovision-package-utilitaire-pour-le-traitement-dimages-satellites" class="nav-link" data-scroll-target="#astrovision-package-utilitaire-pour-le-traitement-dimages-satellites">1️⃣ Astrovision : Package utilitaire pour le traitement d’images satellites</a></li>
  <li><a href="#préparation-des-images-satellites" id="toc-préparation-des-images-satellites" class="nav-link" data-scroll-target="#préparation-des-images-satellites">2️⃣ Préparation des images satellites</a></li>
  <li><a href="#entraînement-des-modèles" id="toc-entraînement-des-modèles" class="nav-link" data-scroll-target="#entraînement-des-modèles">3️⃣ Entraînement des modèles</a></li>
  <li><a href="#inférence-à-partir-de-nouvelles-images" id="toc-inférence-à-partir-de-nouvelles-images" class="nav-link" data-scroll-target="#inférence-à-partir-de-nouvelles-images">4️⃣ Inférence à partir de nouvelles images</a></li>
  <li><a href="#application-cratt" id="toc-application-cratt" class="nav-link" data-scroll-target="#application-cratt">5️⃣ Application CRaTT</a></li>
  <li><a href="#déploiement-des-applications" id="toc-déploiement-des-applications" class="nav-link" data-scroll-target="#déploiement-des-applications">6️⃣ Déploiement des applications</a></li>
  <li><a href="#documentation-du-projet" id="toc-documentation-du-projet" class="nav-link" data-scroll-target="#documentation-du-projet">7️⃣ Documentation du projet</a></li>
  </ul></li>
  <li><a href="#le-projet-sur-le-datalab-sspcloud" id="toc-le-projet-sur-le-datalab-sspcloud" class="nav-link" data-scroll-target="#le-projet-sur-le-datalab-sspcloud">Le projet sur le Datalab – SSPCloud</a>
  <ul class="collapse">
  <li><a href="#le-namespace" id="toc-le-namespace" class="nav-link" data-scroll-target="#le-namespace">Le namespace</a></li>
  <li><a href="#les-données" id="toc-les-données" class="nav-link" data-scroll-target="#les-données">Les données</a></li>
  <li><a href="#les-services" id="toc-les-services" class="nav-link" data-scroll-target="#les-services">Les services</a></li>
  </ul></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">




<section id="structure-du-projet" class="level1">
<h1>📦 Structure du projet</h1>
<p>Ce projet structuré en <strong>7 dépôts Git</strong> open source, hébergés sur GitHub, et organisés au sein de l’équipe <a href="https://github.com/orgs/InseeFrLab/teams/satellite-images">Satellite images</a> de l’organisation <em>InseeFrLab</em>.</p>
<section id="les-différents-dépôts" class="level2">
<h2 class="anchored" data-anchor-id="les-différents-dépôts">📁 Les différents dépôts</h2>
<section id="astrovision-package-utilitaire-pour-le-traitement-dimages-satellites" class="level3">
<h3 class="anchored" data-anchor-id="astrovision-package-utilitaire-pour-le-traitement-dimages-satellites">1️⃣ Astrovision : Package utilitaire pour le traitement d’images satellites</h3>
<p>Pour manipuler des données géospatiales, la bibliothèque incontournable est <a href="https://gdal.org/en/stable/">GDAL</a>. Afin de faciliter son usage en Python, des wrappers comme <a href="https://rasterio.readthedocs.io/en/stable/intro.html">Rasterio</a> sont couramment utilisés. Rasterio offre une interface efficace pour travailler avec des données <em>raster</em>.</p>
<p>Dans notre projet, nous avons développé un package complémentaire, <a href="https://github.com/InseeFrLab/astrovision">Astrovision</a>, qui centralise un ensemble de fonctions utilitaires : découpage d’images, gestion des métadonnées, visualisation, etc. Ce package n’est pas strictement indispensable, cela a été aussi pour nous d’apprendre à déployer un package python. Le projet pourrait fonctionner en s’appuyant exclusivement sur Rasterio, avec quelques adaptations.</p>
</section>
<section id="préparation-des-images-satellites" class="level3">
<h3 class="anchored" data-anchor-id="préparation-des-images-satellites">2️⃣ Préparation des images satellites</h3>
<p>Le dépôt <a href="https://github.com/InseeFrLab/satellite-images-preprocess">satellite-images-preprocess</a> regroupe les fonctions nécessaires à la préparation des images avant l’entraînement des modèles. Ce dépôt n’est utilisé <strong>qu’en amont d’un entraînement</strong>, et n’est donc pas utile lorsque l’on souhaite simplement réaliser de l’inférence sur de nouvelles images.</p>
<p>Le <em>pipeline</em> de preprocessing comprend les étapes suivantes :</p>
<ol type="1">
<li>Génération automatique des <em>labels</em> à partir d’un jeu d’annotations.</li>
<li>Découpage des images sources en tuiles plus petites (pour éviter les problèmes de mémoire lors de l’entraînement).</li>
<li>Suppression des images contenant des nuages.</li>
<li>Filtrage des images selon une région d’intérêt définie.</li>
<li>Calcul des moyennes et écarts types des bandes spectrales pour la normalisation.</li>
<li>Réalisation du split <em>train/test</em> et sauvegarde des données sur un bucket S3.</li>
</ol>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>Le choix de séparer ce dépôt de celui de l’entraînement est discutable, mais repose sur plusieurs objectifs :</p>
<ul>
<li>Isoler les différentes étapes du pipeline.</li>
<li>Éviter de ré-exécuter inutilement le preprocessing à chaque entraînement.</li>
<li>Faciliter la modularité du projet. Ces objectifs ne sont pas forcément en contradiction avec le fait de tout centraliser dans un seul package.</li>
</ul>
</div>
</div>
</section>
<section id="entraînement-des-modèles" class="level3">
<h3 class="anchored" data-anchor-id="entraînement-des-modèles">3️⃣ Entraînement des modèles</h3>
<p>L’entraînement est géré par le dépôt <a href="https://github.com/InseeFrLab/satellite-images-train">satellite-images-train</a>. Il est nécessaire d’avoir à disposition des images déjà prétraitées et stockées sur le S3, ce qui peut être fait via le dépôt de preprocessing.</p>
<p>L’objectif de ce dépôt est d’offrir un environnement modulaire permettant d’expérimenter différentes stratégies d’entraînement et d’optimiser les hyperparamètres propre à l’entraînement (et rien d’autres !). Tous les résultats sont loggués via <a href="https://projet-slums-detection-mlflow.user.lab.sspcloud.fr/">MLFlow</a>.</p>
<p>Deux familles de modèles de segmentation sont actuellement intégrées :</p>
<ul>
<li><a href="https://pytorch.org/hub/pytorch_vision_deeplabv3_resnet101/">DeepLabv3</a> (et sa variante binaire).</li>
<li><a href="https://github.com/NVlabs/SegFormer">Segformer</a>, de <strong>b0 à b5</strong>.</li>
</ul>
<p>Côté fonctions de perte, plusieurs variantes de l’entropie croisée sont disponibles (classique, pondérée, binaire, etc.).</p>
</section>
<section id="inférence-à-partir-de-nouvelles-images" class="level3">
<h3 class="anchored" data-anchor-id="inférence-à-partir-de-nouvelles-images">4️⃣ Inférence à partir de nouvelles images</h3>
<p>Le dépôt <a href="https://github.com/InseeFrLab/satellite-images-inference">satellite-images-inference</a> est dédié à l’inférence. C’est peut être le dépôt le moins “isolé” dans le sens où il contient à la fois les codes de l’API qui est utilisée pour réaliser l’inférence mais également divers scripts nécessaires que cela soit pour l’inférence, le post-processing ou bien la reception de nouvelles images à inférer.</p>
<p>L’<strong>API</strong>, développée avec <strong>FastAPI</strong>, est déployée sur <strong>SSPCloud</strong>. Elle propose trois <em>endpoints</em> principaux :</p>
<ol type="1">
<li><code>GET /predict_image</code> — Prédiction d’une image individuelle stockée sur S3.</li>
<li><code>GET /predict_cluster</code> — Prédiction sur un îlot identifié par son code (peut inclure plusieurs images).</li>
<li><code>GET /predict_bbox</code> — Prédiction sur une <em>bounding box</em> définie par des coordonnées GPS (peut inclure plusieurs images).</li>
</ol>
<p>Un système de <strong>cache</strong> est en place pour éviter les redondances de calcul sur une même image.</p>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
⚠️ <strong>Limites actuelles de l’API :</strong>
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li>Les prédictions en batch ne sont pas possibles directement (elles doivent être séquentielles) puisque seuls des <em>endpoints</em> <code>GET</code> sont disponibles.</li>
<li>Certaines opérations pourraient être asynchrones pour améliorer les performances.</li>
<li>L’API reproduit le preprocessing, idéalement, il faudrait <code>wrapper</code> tout dans un modèle MLFlow et donc créer une custom class lors de l’entrainement.</li>
</ul>
</div>
</div>
</section>
<section id="application-cratt" class="level3">
<h3 class="anchored" data-anchor-id="application-cratt">5️⃣ Application CRaTT</h3>
<p>Le code de l’application CRaTT permettant de visualiser les résultats sur des territoires entier est disponible dans le dépôt <a href="https://github.com/inseeFrLab/satellite-images-webapp">satellite-images-webapp</a>. L’application est construite avec <a href="https://observablehq.com/framework/">Observable Framework</a> qui permet de déployer sur un site statique tout en gardant un certain niveau d’interactivité dans les visualisations que l’on peut montrer. La manipulation des données peut se faire dans le langage de notre choix (Python, R, SQL, etc.) et les visualisation se font en JavaScript.</p>
<p>Le déploiement est réalisé via Github Pages et est accessible à l’adresse suivante : <a href="">https://inseefrlab.github.io/satellite-images-webapp/</a>.</p>
</section>
<section id="déploiement-des-applications" class="level3">
<h3 class="anchored" data-anchor-id="déploiement-des-applications">6️⃣ Déploiement des applications</h3>
<p>Pour gérer les différents déploiements de l’ensemble du projet, nous avons créer un dépôt GitOps. Il s’agit du dépôt <a href="https://github.com/inseeFrLab/satellite-images-cd">satellite-images-cd</a>. Il contient les <em>manifests</em> Kubernetes des services déployés ainsi que les templates d’ArgoCD afin d’avoir un déploiement continu.</p>
<p>En avril 2025, 2 services sont déployés :</p>
<ul>
<li>l’API d’inférence</li>
<li>le Geoserver pour la mise à disposition des tuiles d’images</li>
</ul>
</section>
<section id="documentation-du-projet" class="level3">
<h3 class="anchored" data-anchor-id="documentation-du-projet">7️⃣ Documentation du projet</h3>
<p>La documentation que vous lisez actuellement est réaliser avec Quarto et toute contribution est la bienvenue dans le dépôt <a href="https://github.com/inseeFrLab/satellite-images-docs">satellite-images-docs</a>.</p>
</section>
</section>
<section id="le-projet-sur-le-datalab-sspcloud" class="level2">
<h2 class="anchored" data-anchor-id="le-projet-sur-le-datalab-sspcloud">Le projet sur le Datalab – SSPCloud</h2>
<section id="le-namespace" class="level3">
<h3 class="anchored" data-anchor-id="le-namespace">Le namespace</h3>
<p>Afin de pouvoir contribuer au projet il est nécessaire d’avoir accès au namespace <code>projet-slums-detection</code>. Pour cela, vous pouvez contacter la Diit.</p>
</section>
<section id="les-données" class="level3">
<h3 class="anchored" data-anchor-id="les-données">Les données</h3>
<p>Le S3 associé au projet est structuré en plusieurs dossiers.</p>
<section id="data-raw" class="level4">
<h4 class="anchored" data-anchor-id="data-raw">📁 <strong>data-raw</strong></h4>
<p>Ce dossier contient les images satellites telles qu’on les reçoit sans modification. Seules les données de la Guyane et de Saint-Martin sont un peu différentes avec des sous dossiers <code>brut</code> car elles ont nécessité des ajustements préalables. En effet, pour tous les autres départements les données proviennent de l’IGN qui nous transmets les mosaïques d’images 2000x2000.</p>
<p>La structure du dossier est :</p>
<p><code>data-raw/&lt;SOURCE&gt;/&lt;DEPARTEMENT&gt;/&lt;ANNEE&gt;/*.tif</code></p>
</section>
<section id="data-label" class="level4">
<h4 class="anchored" data-anchor-id="data-label">📁 <strong>data-label</strong></h4>
<p>Ce dossier contient les données géographiques contenant les labels que nous utilisons lors de notre entraînement et que nous considérons donc comme <strong>vraie valeur</strong>. En fonction de la source de l’annotation le format des fichiers peut différer. Pour le moment, 2 sources de données sont utilisées il s’agit de la <a href="https://geoservices.ign.fr/bdtopo">BDTOPO</a> et de <a href="https://cosia.ign.fr/">COSIA</a> et les données sont stockées respectivement au format Shapefile et au format Geopackage.</p>
<p>La structure du dossier est :</p>
<pre><code>data-label/
├── BDTOPO/
│   ├── bdtopo-id2label.json
│   └── &lt;DEPARTEMENT&gt;/
│       └── &lt;ANNEE&gt;/
├── COSIA/
│   ├── cosia-id2label.json
│   └── &lt;DEPARTEMENT&gt;/
│       └── &lt;ANNEE&gt;/</code></pre>
</section>
<section id="data-preprocessed" class="level4">
<h4 class="anchored" data-anchor-id="data-preprocessed">📁 <strong>data-preprocessed</strong></h4>
<p>Le dossier <code>data-preprocessed/</code> contient l’ensemble des données préparées pour l’entraînement d’un modèle. Il est organisé en deux sous-dossiers principaux, le dossier <code>labels/</code> qui contient les fichiers d’étiquettes (<code>.npy</code>) associés à chaque tuile d’image ainsi que le dossier <code>patchs/</code> contient les images (<code>.jp2</code>) associées portant le même nom.</p>
<p>La structure du dossier est donc :</p>
<pre><code>data-preprocessed/
├── labels/                        # Étiquettes
│   └── &lt;LABELER&gt;/                 # Annotateur (ex: COSIA, BDTOPO...)
│       └── &lt;TASK&gt;/                # Tâche spécifique (ex: segmentation, classification...)
│           └── &lt;SOURCE&gt;/          # Source de données (ex: PLEIADES, SENTINEL...)
│               └── &lt;DEPARTEMENT&gt;/ # Département (ex: MAYOTTE, REUNION...)
│                   └── &lt;ANNEE&gt;/   # Année de la donnée (ex: 2023)
│                       └── &lt;TILE-SIZE&gt;/  # Taille des tuiles (ex: 125, 250...)
│                           ├── train/    # Jeu d'entraînement
│                           │   └── *.npy # Fichiers numpy
│                           └── test/     # Jeu de test
│                               └── *.npy # Fichiers numpy
├── patchs/                        # Images
│   └── &lt;LABELER&gt;/                 # Annotateur (ex: COSIA, BDTOPO...)
│       └── &lt;TASK&gt;/                # Tâche spécifique (ex: segmentation, classification...)
│           └── &lt;SOURCE&gt;/          # Source de données (ex: PLEIADES, SENTINEL...)
│               └── &lt;DEPARTEMENT&gt;/ # Département (ex: MAYOTTE, REUNION...)
│                   └── &lt;ANNEE&gt;/   # Année de la donnée (ex: 2023)
│                       └── &lt;TILE-SIZE&gt;/  # Taille des tuiles (ex: 125, 250...)
│                           ├── train/    # Jeu d'entraînement
│                           │   └── *.jp2 # Fichiers images jp2
│                           └── test/     # Jeu de test
│                               └── *.jp2 # Fichiers images jp2
</code></pre>
</section>
<section id="data-prediction" class="level4">
<h4 class="anchored" data-anchor-id="data-prediction">📁 <strong>data-prediction</strong></h4>
<p>Le dossier <code>data-prediction/</code>regroupe les résultats de prédictions générées par différents modèles. Les prédictions sont disponibles au format Parquet mais également au format GeoPackage pour pouvoir les utiliser dans le Geoserver.</p>
<p>La structure du dossier est :</p>
<pre><code>data-prediction/
└── &lt;SOURCE&gt;/                  # Source de données (ex: PLEIADES, SENTINEL...)
    └── &lt;DEPARTEMENT&gt;/          # Département (ex: MAYOTTE, REUNION...)
        └── &lt;ANNEE&gt;/            # Année de la donnée (ex: 2023)
            └── &lt;MODEL-NAME&gt;/   # Nom du modèle utilisé pour la prédiction
                └── &lt;MODEL-VERSION&gt;/ # Version du modèle (ex: 1, 2...)
                    ├── *.parquet    # Fichiers de prédiction au format parquet
                    └── *.gpkg       # Fichiers de prédiction au format GeoPackage</code></pre>
</section>
<section id="cache-predictions" class="level4">
<h4 class="anchored" data-anchor-id="cache-predictions">📁 <strong>cache-predictions</strong></h4>
<p>Le dossier <code>cache-predictions/</code> contient les logits intermédiaires produits par les modèles lors du processus de prédiction afin de ne pas refaire une prédiction qui aurait déjà été réalisée. L’organisation du dossier reprend la même hiérarchie que <code>data-prediction</code> :</p>
<pre><code>cache-predictions/
└── &lt;SOURCE&gt;/                  # Source de données (ex: PLEIADES, SENTINEL...)
    └── &lt;DEPARTEMENT&gt;/          # Département (ex: MAYOTTE, REUNION...)
        └── &lt;ANNEE&gt;/            # Année de la donnée (ex: 2023)
            └── &lt;MODEL-NAME&gt;/   # Nom du modèle utilisé pour la prédiction
                └── &lt;MODEL-VERSION&gt;/ # Version du modèle (ex: 1, 2...)
                    └── *.npy       # Logits prédits</code></pre>
</section>
<section id="data-roi" class="level4">
<h4 class="anchored" data-anchor-id="data-roi">📁 <strong>data-roi</strong></h4>
<p>Le dossier <code>data-roi</code> contient les contours géographique de chaque département afin de pouvoir filtrer les images efficacement que ce soit lors de l’étape de preprocessing que lors de l’étape de l’inférence. Les contours sont à la fois stockés en parquet et en geojson (un seul des deux formats pourrait suffire).</p>
<p>Ces données ont été construites à la main à partir de données officielles. Les contours des territoires n’étant pas sensés changer, il n’y a pas à mettre à jour ces données.</p>
<p>La structure du dossier est :</p>
<pre><code>data-roi/
├── &lt;DEPARTEMENT&gt;.parquet
└── &lt;DEPARTEMENT&gt;.geojson</code></pre>
</section>
<section id="cluster-geom-raw" class="level4">
<h4 class="anchored" data-anchor-id="cluster-geom-raw">📁 <strong>cluster-geom-raw</strong></h4>
<p>Le dossier <code>cluster-geom-raw</code> contient tout l’historique des géométries d’îlots non preprocessé.</p>
<p>La géométrie des îlots est arrêtée chaque année au 31 octobre ; c’est cette version qui s’applique pendant le recensement de la population (RP).<br>
Par exemple, pour l’enquête annuelle de recensement 2026, il faudra utiliser la géométrie des îlots arrêtée au 31 octobre 2025.</p>
<p>Dans tous les cas, il est indispensable de s’assurer que le SERN Géographie et le ST Mayotte disposent bien des mêmes référentiels d’îlots. Des ajustements exceptionnels pourraient être nécessaires compte tenu de l’urgence post-Chido.</p>
<p>Une fois le fichier avec les dernières géométries traité, les nouveaux fichiers parquet sont disponibles dans <strong>data-clusters</strong>.</p>
</section>
<section id="data-clusters" class="level4">
<h4 class="anchored" data-anchor-id="data-clusters">📁 <strong>data-clusters</strong></h4>
<p>Le dossier <code>data-clusters</code> contient les contours géographique de chaque îlot pour les différents départements. Ces informations sont nécessaires lors de l’inférence pour un îlot donné ainsi que pour le déploiement de la webapp qui permet de réaliser des statistiques par îlot. Le dossier est simplement un fichier parquet partitionné :</p>
<pre><code>data-clusters/
├── dep=&lt;DEPARTEMENT&gt;/
      └── part-0.parquet</code></pre>
</section>
</section>
<section id="les-services" class="level3">
<h3 class="anchored" data-anchor-id="les-services">Les services</h3>
<p>Le projet utilise plusieurs service au sein du datalab.</p>
<ul>
<li><h4 id="mlflow" class="anchored">MLFlow</h4></li>
</ul>
<p>MLflow est utilisé lors de la phase d’entraînement pour <em>tracker</em> et optimiser nos modèles. Il permet de <em>logguer</em> les hyperparamètres, les métriques et les artefacts générés au cours des expérimentations. MLflow joue également le rôle de <em>Model Registry</em>, dans lequel à chaque modèle est associé un tag tel que <em>staging</em>, <em>production</em> ou <em>archived</em>. Cela facilite le versionnement et la bonne gestion du cycle de vie des modèles dans le temps</p>
<ul>
<li><h4 id="argocd" class="anchored">ArgoCD</h4></li>
</ul>
<p>ArgoCD est déployé pour superviser et gérer automatiquement les applications présentes dans notre namespace. Il permet de surveiller en permanence l’état de déploiement des applications et détecte automatiquement toute modification des manifests dans le dépôt GitOps dédié (<a href="">https://github.com/inseeFrLab/satellite-images-cd</a>). Lorsqu’une modification est détectée, ArgoCD applique automatiquement les changements sur le cluster, garantissant une parfaite synchronisation entre le code source et l’état effectif des déploiements.</p>
<ul>
<li><h4 id="argo-workflows" class="anchored">Argo Workflows</h4></li>
</ul>
<p>Argo Workflows est utilisé pour orchestrer l’exécution parallèle de scripts, ce qui optimise considérablement les temps de calcul. Les workflows sont décrits dans des fichiers YAML stockés dans les répertoires <code>argo-workflows/</code> présents dans les différents dépôts. Argo Workflows est sollicité à différents stades du projet, notamment pour exécuter les étapes de preprocessing des données, l’entraînement de modèles en parallèle, ainsi que l’inférence à grande échelle.</p>
<ul>
<li><h4 id="geoserver" class="anchored">Geoserver</h4></li>
</ul>
<p>GeoServer permet la publication et la mise à disposition de données géographiques sous forme de flux normalisés (WMS, WFS, WCS). Contrairement aux autres services mentionnés, GeoServer n’est pas directement provisionné par le Datalab, ni déployé via Helm Chart.</p>
<p>À ce jour, GeoServer ne peut pas accéder directement aux fichiers stockés sur un stockage objet type S3. En conséquence, toutes les images ou données que nous souhaitons exposer doivent être dupliquées dans un PVC associé au pod GeoServer…</p>


</section>
</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
    const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
    const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
    let newTheme = '';
    if(darkModeDefault) {
      newTheme = isAlternate ? baseTheme : alternateTheme;
    } else {
      newTheme = isAlternate ? alternateTheme : baseTheme;
    }
    const changeGiscusTheme = () => {
      // From: https://github.com/giscus/giscus/issues/336
      const sendMessage = (message) => {
        const iframe = document.querySelector('iframe.giscus-frame');
        if (!iframe) return;
        iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
      }
      sendMessage({
        setConfig: {
          theme: newTheme
        }
      });
    }
    const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
    if (isGiscussLoaded) {
      changeGiscusTheme();
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  const darkModeDefault = false;
  let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
    toggleGiscusIfUsed(toAlternate, darkModeDefault);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/github\.com\/orgs\/InseeFrLab\/teams\/satellite-images\/repositories");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
  </div>
  <div class="nav-page nav-page-next">
      <a href="../../src/documentation/sections/satellite_image.html" class="pagination-link" aria-label="Une image satellite">
        <span class="nav-page-text">Une image satellite</span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
<p>This page is built with ❤️ and <a href="https://quarto.org/">Quarto</a>.</p>
</div>   
    <div class="nav-footer-center">
      &nbsp;
    </div>
    <div class="nav-footer-right">
      <ul class="footer-items list-unstyled">
    <li class="nav-item">
    <a class="nav-link" href="../../LICENSE">
<p>License</p>
</a>
  </li>  
</ul>
    </div>
  </div>
</footer>




</body></html>