## Segmentation s√©mantique

- [**Vision par ordinateur**]{.orange}  
- [**Classer chaque pixel**]{.blue2} d‚Äôune image  
- Pour nos besoins : conna√Ætre les pixels de [**cat√©gorie "b√¢tie"**]{.orange}   

<div style="text-align:center;">
  ![Exemple de segmentation "b√¢timent"](../img/segmentation.png){width=30%}
</div>

::: notes
Pour d√©tecter le b√¢ti de fa√ßon automatique, nous nous sommes tourn√© vers la vision par ordinateur, qui est une branche du domaine de l'intelligence artificielle. La segmentation s√©mantique permet de classer chaque pixel d'une image dans l'une des classes d√©finie en amont. La segmentation semantique peut utiliser toute sorte de classe, mais voici un exemple de r√©sultat qui nous interesse :
:::

## Entra√Æner un mod√®le de segmentation

- Mod√®le entra√Æn√© pour de la segmentation automatique [**depuis des exemples d'annotations**]{.orange}
- [**Il faut**]{.orange} :
    - Une collection d'[**images satellites**]{.blue2} üõ∞Ô∏è
    - [**Des annotations**]{.blue2} üìç
- Le mod√®le apprend √† reproduire les annotations des images pour [**g√©n√©raliser**]{.orange} sur de nouvelles images  

::: notes

- Pour notre mod√®le entra√Æn√© pour de la segmentation automatique [**depuis des exemples d'annotations**]{.orange}, les mosaiques d'images et les collections d'annotations COSIA de MAYOTTE 2023, MARTINIQUE 2022 et GUADELOUPE 2022 ont √©t√© utilis√©s, et des zones de test fix√©es ont √©t√© d√©finies.

- Le mod√®le apprend √† reproduire les annotations des images pour [**g√©n√©raliser**]{.orange} sur de nouvelles images 
:::

## De la segmentation √† la d√©tection de changements

![](../img/strategy_segmentation.png){width=80%}

## Mod√®le utilis√©

- [**Architecture du mod√®le**]{.orange} üß†
    - Base du mod√®le : [**SegFormer**]{.blue2}, un mod√®le l√©ger et performant
    - [**Inspir√©e des Transformers**]{.blue2}, utilis√©s dans l‚ÄôIA moderne
    - Int√®gre des [**m√©canismes d‚Äôattention**]{.blue2} pour rep√©rer les zones importantes
    - Repr√©sente [**l‚Äô√©tat de l‚Äôart**]{.blue2} en segmentation d‚Äôimage

- [**Adapt√©**]{.orange} √† nos donn√©es satellites


::: notes
Le mod√®le que nous avons s√©lectionn√© s‚Äôappuie sur une architecture appel√©e **SegFormer**.

Il est bas√© sur une technologie appel√©e **Transformer**, connue pour ses performances dans de nombreux domaines de l‚Äôintelligence artificielle, notamment le traitement du langage, mais qui a aussi √©t√© adapt√©e √† l‚Äôimage. En une publication, le Transformer a enterr√© 10 ans de recherches‚Ä¶ et ouvert la voie √† BERT, GPT, ViT et tout ce qu‚Äôon utilise aujourd‚Äôhui.

Un des atouts de cette architecture, ce sont les **m√©canismes d‚Äôattention**, qui permettent au mod√®le de se concentrer sur les parties les plus importantes de l‚Äôimage pour produire les pr√©dictions.

Enfin, nous avons **ajust√© le mod√®le √† nos donn√©es** sp√©cifiques : des images satellites √† 3 bandes, et une annotation en 17 classes correspondant √† diff√©rents types de surfaces ou de b√¢timents.
:::


## √âvaluation

Pour √©valuer les performances du mod√®le entra√Æn√© :  
<div style="text-align: center;">
[**IOU**]{.orange} = Intersection Over Union  
</div>

![](../img/schemaIOU.png){width=80% fig-align="center"}

::: notes
L'IoU, ou *Intersection over Union*, est une mesure qu'on utilise pour √©valuer la qualit√© d‚Äôune pr√©diction en segmentation d‚Äôimage.

Concr√®tement, on compare deux zones :  
- celle que le mod√®le a pr√©dite comme appartenant √† une certaine classe,  
- et la zone r√©elle, qu‚Äôon appelle le *label de v√©rit√© terrain*.

On mesure alors **l‚Äôintersection** entre ces deux zones ‚Äì c‚Äôest la partie correctement pr√©dite ‚Äì  
et on la divise par **l‚Äôunion** des deux ‚Äì c‚Äôest-√†-dire l‚Äôensemble de tout ce qui a √©t√© soit pr√©dit, soit annot√©.

Un IoU de 1 signifie une correspondance parfaite.  
Un IoU de 0 signifie aucune correspondance.

Plus l‚ÄôIoU est √©lev√©, plus la pr√©diction est pr√©cise.  
C‚Äôest une m√©trique particuli√®rement adapt√©e pour des t√¢ches comme la n√¥tre, o√π on doit pr√©dire la forme exacte des b√¢timents ou des routes, pixel par pixel.
:::
